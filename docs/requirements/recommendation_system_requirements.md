# 웹소설나침반 - 추천 시스템 요구사항 명세서

## 문서 정보
- **프로젝트명**: 웹소설나침반 (WebNovel Compass)
- **문서 버전**: 1.0
- **작성일**: 2025-07-04
- **문서 유형**: 추천 시스템 요구사항 명세서

## 목차
1. [개요](#1-개요)
2. [기능 요구사항](#2-기능-요구사항)
   - 2.1 [개인화 추천 엔진](#21-개인화-추천-엔진)
   - 2.2 [추천 컨텍스트 관리](#22-추천-컨텍스트-관리)
   - 2.3 [신규 사용자/작품 처리](#23-신규-사용자작품-처리)
   - 2.4 [추천 결과 관리](#24-추천-결과-관리)
   - 2.5 [피드백 수집 및 학습](#25-피드백-수집-및-학습)
3. [비기능 요구사항](#3-비기능-요구사항)
4. [데이터 요구사항](#4-데이터-요구사항)
5. [보안 요구사항](#5-보안-요구사항)
6. [인터페이스 요구사항](#6-인터페이스-요구사항)
7. [제약사항](#7-제약사항)

### 1.1 목적
사용자 취향과 행동 데이터를 분석하여 개인화된 웹소설 추천을 제공하는 시스템의 요구사항을 정의한다.

### 1.2 범위
- 개인화 추천 알고리즘 (협업 필터링, 콘텐츠 기반)
- 추천 결과 관리 및 캐싱
- 추천 성능 측정 및 피드백 수집
- 실시간 추천 업데이트
- 다양한 추천 컨텍스트 지원

### 1.3 용어 정의
- **협업 필터링**: 유사한 취향을 가진 사용자들의 선호도를 기반으로 추천
- **콘텐츠 기반 필터링**: 아이템의 속성과 사용자 프로필을 기반으로 추천
- **하이브리드 추천**: 여러 추천 방식을 결합한 추천 시스템
- **콜드 스타트**: 신규 사용자나 아이템에 대한 추천 문제

## 2. 기능 요구사항

### 2.1 개인화 추천 엔진

#### 2.1.1 사용자 기반 협업 필터링 (REQ-REC-001)
**기능 설명**: 유사한 취향의 사용자들이 선호하는 작품 추천
**입력**: 사용자 ID, 추천 개수
**알고리즘**: 
- 코사인 유사도 기반 사용자 유사성 계산
- K-Nearest Neighbors (k=50)
- 평점 예측 및 상위 N개 추천
**처리**:
- 사용자-아이템 평점 매트릭스 구성
- 유사 사용자 그룹 식별
- 가중 평균을 통한 평점 예측
**출력**: 추천 웹소설 목록, 예상 평점, 신뢰도
**성능**: 100만 사용자 기준 200ms 이하

#### 2.1.2 아이템 기반 협업 필터링 (REQ-REC-002)
**기능 설명**: 사용자가 선호한 작품과 유사한 작품 추천
**알고리즘**: 
- 피어슨 상관계수 기반 아이템 유사성
- 조정된 코사인 유사도 적용
**처리**:
- 아이템-아이템 유사도 매트릭스 사전 계산
- 사용자 평점 기반 유사 아이템 발굴
- 가중 합계를 통한 추천 점수 계산

#### 2.1.3 매트릭스 팩토라이제이션 (REQ-REC-003)
**기능 설명**: 잠재 요인 모델을 통한 고도화된 협업 필터링
**알고리즘**: Alternating Least Squares (ALS)
**파라미터**:
- 잠재 요인 수: 100개
- 정규화 파라미터: 0.01
- 반복 횟수: 20회
**처리**:
- 희소 평점 매트릭스 분해
- 사용자-요인, 아이템-요인 매트릭스 학습
- 주기적 모델 재학습 (주 1회)

#### 2.1.4 콘텐츠 기반 필터링 (REQ-REC-004)
**기능 설명**: 웹소설 메타데이터 기반 추천
**특징 벡터 구성**:
- 장르 원-핫 인코딩 (20차원)
- 태그 TF-IDF 벡터 (500차원)
- 줄거리 TF-IDF 벡터 (1000차원)
- 작가 임베딩 (50차원)
**처리**:
- 사용자 프로필 벡터 구성 (평점 가중 평균)
- 코사인 유사도 기반 매칭
- 장르 선호도 가중치 적용

#### 2.1.5 하이브리드 추천 (REQ-REC-005)
**기능 설명**: 다중 알고리즘 결합을 통한 최종 추천
**결합 방식**:
- 가중 선형 결합: 협업 필터링 60% + 콘텐츠 기반 40%
- 스위칭: 사용자 활동 수준에 따른 알고리즘 선택
- 앙상블: 다중 모델 투표를 통한 최종 결정
**가중치 조정**: 사용자별 개인화 가능

### 2.2 추천 컨텍스트 관리

#### 2.2.1 홈페이지 추천 (REQ-CTX-001)
**추천 섹션**:
- "당신을 위한 추천" (개인화 추천 20개)
- "비슷한 취향의 사용자가 본 작품" (10개)
- "최근 읽은 작품과 유사한 작품" (10개)
- "새로 나온 작품 중 관심사와 일치" (5개)
**개인화 요소**: 사용자 활동 시간, 선호 장르, 최근 행동

#### 2.2.2 작품 상세 페이지 추천 (REQ-CTX-002)
**추천 유형**:
- "이 작품을 본 사용자가 함께 본 작품" (10개)
- "이 작품과 비슷한 작품" (10개)
- "같은 작가의 다른 작품" (5개)
**실시간 업데이트**: 사용자 조회 시 즉시 계산

#### 2.2.3 검색 결과 재순위화 (REQ-CTX-003)
**기능 설명**: 검색 결과를 사용자 취향에 맞게 재정렬
**처리**:
- 기본 검색 점수와 개인화 점수 결합
- 사용자 선호 장르/태그 부스팅
- 최근 관심 작가 우선순위 향상

#### 2.2.4 시간대별 추천 (REQ-CTX-004)
**기능 설명**: 시간대별 사용자 선호도 반영
**시간대 분석**:
- 아침(6-12시): 가벼운 내용 우선
- 오후(12-18시): 다양한 장르 균형
- 저녁(18-24시): 몰입도 높은 장편 우선
- 심야(0-6시): 성인 콘텐츠 허용 확대

### 2.3 신규 사용자/작품 처리

#### 2.3.1 콜드 스타트 해결 (REQ-COLD-001)
**신규 사용자 처리**:
- 인기 작품 기반 초기 추천 (전체/장르별 TOP 20)
- 온보딩 취향 조사를 통한 초기 프로필 구성
- 인구통계학적 정보 활용 (연령, 성별)
**신규 작품 처리**:
- 콘텐츠 기반 필터링 우선 적용
- 작가의 기존 작품 팬층 대상 추천
- 장르/태그 유사성 기반 초기 노출

#### 2.3.2 다양성 보장 (REQ-DIV-001)
**기능 설명**: 추천 결과의 다양성 및 참신성 확보
**다양성 전략**:
- 장르 다양성: 최소 3개 이상 장르 포함
- 인기도 다양성: 인기작 70% + 틈새작품 30%
- 시간적 다양성: 다양한 연재 시기 작품 혼합
**참신성 지표**: 사용자가 이전에 노출되지 않은 작품 비율 30% 이상

### 2.4 추천 결과 관리

#### 2.4.1 추천 결과 저장 (REQ-STORE-001)
**기능 설명**: 계산된 추천 결과의 효율적 저장 및 관리
**저장 방식**:
- Redis 캐시: 실시간 추천 결과 (1시간 TTL)
- PostgreSQL: 배치 계산 결과 (24시간 유효)
- 사용자별 개인화 추천 리스트 관리
**갱신 정책**: 사용자 활동 발생 시 점진적 업데이트

#### 2.4.2 추천 설명 생성 (REQ-EXPLAIN-001)
**기능 설명**: 추천 이유 자동 생성
**설명 유형**:
- "OOO 장르를 좋아하셔서 추천해드려요"
- "비슷한 취향의 독자들이 좋아한 작품이에요"
- "최근 읽으신 'XXX'와 비슷한 작품이에요"
- "평점 4.5점의 높은 평가를 받은 작품이에요"
**개인화**: 사용자 활동 패턴에 따른 설명 방식 조정

#### 2.4.3 추천 품질 모니터링 (REQ-MONITOR-001)
**성능 지표**:
- 정확도: Precision@K, Recall@K, NDCG
- 다양성: Intra-List Diversity, Coverage
- 참신성: Novelty, Serendipity
- 비즈니스: CTR, Conversion Rate, Dwell Time
**실시간 모니터링**: 대시보드를 통한 지표 추적

### 2.5 피드백 수집 및 학습

#### 2.5.1 명시적 피드백 (REQ-FEEDBACK-001)
**피드백 유형**:
- 추천 평가: 좋아요/싫어요 버튼
- 추천 이유 선택: "관심 없음", "이미 읽음", "취향 아님"
- 별점 피드백: 1-5점 평가
**처리**: 피드백 즉시 수집 및 다음 추천에 반영

#### 2.5.2 암묵적 피드백 (REQ-FEEDBACK-002)
**행동 데이터 수집**:
- 클릭률: 추천 항목 클릭 여부
- 체류 시간: 작품 페이지 머무름 시간
- 스크롤 깊이: 작품 정보 탐색 정도
- 북마크/찜: 관심 표현 행동
**가중치**: 명시적 피드백(70%) + 암묵적 피드백(30%)

#### 2.5.3 온라인 학습 (REQ-LEARN-001)
**기능 설명**: 실시간 피드백을 통한 모델 지속 개선
**학습 방식**:
- 증분 학습: 새로운 데이터 점진적 반영
- 강화 학습: 다중 armed bandit 알고리즘
- A/B 테스트: 알고리즘 성능 비교 실험
**학습 주기**: 일간 증분 학습 + 주간 전체 재학습

## 3. 비기능 요구사항

### 3.1 성능 요구사항
- **추천 응답 시간**: 200ms 이하
- **동시 요청 처리**: 초당 1,000건 이상
- **캐시 적중률**: 90% 이상
- **모델 학습 시간**: 전체 재학습 4시간 이내

### 3.2 확장성 요구사항
- **사용자 확장**: 100만 명 이상 지원
- **아이템 확장**: 100만 개 이상 지원
- **분산 처리**: 수평 확장 가능한 아키텍처
- **모델 서빙**: 다중 인스턴스 로드 밸런싱

### 3.3 정확도 요구사항
- **Precision@10**: 15% 이상
- **클릭률 (CTR)**: 5% 이상
- **전환율**: 추천을 통한 작품 읽기 시작 비율 20% 이상
- **사용자 만족도**: 추천 만족도 평가 3.5/5.0 이상

## 4. 데이터 요구사항

### 4.1 사용자 행동 데이터
```sql
user_interactions (
    interaction_id BIGINT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    novel_id BIGINT NOT NULL,
    interaction_type ENUM('VIEW', 'CLICK', 'BOOKMARK', 'RATING', 'REVIEW'),
    value DECIMAL(3,2), -- 평점 또는 가중치
    context VARCHAR(50), -- 'HOMEPAGE', 'SEARCH', 'RECOMMENDATION'
    created_at TIMESTAMP,
    session_id VARCHAR(100)
)
```

### 4.2 추천 결과 저장
```sql
recommendations (
    recommendation_id BIGINT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    context VARCHAR(50), -- 추천 컨텍스트
    novel_ids JSON, -- 추천 작품 목록
    scores JSON, -- 각 작품별 점수
    explanations JSON, -- 추천 이유
    algorithm_version VARCHAR(20),
    generated_at TIMESTAMP,
    expires_at TIMESTAMP
)
```

### 4.3 사용자 프로필
```sql
user_profiles (
    user_id BIGINT PRIMARY KEY,
    genre_preferences JSON, -- 장르별 선호도 점수
    tag_preferences JSON, -- 태그별 선호도 점수
    author_preferences JSON, -- 작가별 선호도 점수
    avg_rating DECIMAL(3,2),
    interaction_count INT,
    last_active TIMESTAMP,
    profile_version INT,
    updated_at TIMESTAMP
)
```

### 4.4 추천 피드백
```sql
recommendation_feedback (
    feedback_id BIGINT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    recommendation_id BIGINT NOT NULL,
    novel_id BIGINT NOT NULL,
    feedback_type ENUM('LIKE', 'DISLIKE', 'NOT_INTERESTED', 'ALREADY_READ'),
    feedback_value INT, -- 1: 긍정, -1: 부정, 0: 중립
    created_at TIMESTAMP
)
```

### 4.5 모델 메타데이터
```sql
model_metadata (
    model_id BIGINT PRIMARY KEY,
    model_type VARCHAR(50), -- 'COLLABORATIVE', 'CONTENT_BASED', 'HYBRID'
    version VARCHAR(20),
    parameters JSON,
    training_data_size INT,
    performance_metrics JSON,
    is_active BOOLEAN,
    created_at TIMESTAMP,
    deployed_at TIMESTAMP
)
```

## 5. 보안 요구사항

### 5.1 개인정보 보호
- **데이터 익명화**: 분석용 데이터 개인 식별 정보 제거
- **최소 수집**: 추천에 필요한 최소한의 데이터만 수집
- **데이터 보관**: 사용자 탈퇴 시 개인화 데이터 완전 삭제

### 5.2 알고리즘 보안
- **편향성 방지**: 특정 그룹 차별 방지 검증
- **조작 방지**: 의도적 평점 조작 탐지 시스템
- **투명성**: 추천 알고리즘 설명 가능성 확보

## 6. 인터페이스 요구사항

### 6.1 추천 API
```
# 개인화 추천
GET  /api/v1/recommendations/personal          # 홈페이지 추천
GET  /api/v1/recommendations/similar/{novel_id} # 유사 작품 추천
GET  /api/v1/recommendations/trending          # 트렌딩 추천
GET  /api/v1/recommendations/new               # 신작 추천

# 추천 피드백
POST /api/v1/recommendations/{id}/feedback     # 추천 피드백 등록
GET  /api/v1/recommendations/{id}/explanation  # 추천 이유 조회

# 사용자 프로필
GET  /api/v1/users/{id}/profile                # 사용자 프로필 조회
PUT  /api/v1/users/{id}/preferences            # 선호도 설정

# 추천 설정
GET  /api/v1/users/{id}/recommendation-settings # 추천 설정 조회
PUT  /api/v1/users/{id}/recommendation-settings # 추천 설정 변경
```

### 6.2 내부 마이크로서비스 API
```
# Spring Boot ↔ Python FastAPI
POST /internal/v1/recommendations/compute      # 추천 계산 요청
POST /internal/v1/models/retrain              # 모델 재학습 요청
GET  /internal/v1/models/status               # 모델 상태 조회
POST /internal/v1/feedback/batch              # 피드백 배치 전송
```

### 6.3 외부 시스템 연동
- **메시지 큐**: Redis Pub/Sub를 통한 실시간 이벤트 처리
- **모니터링**: Prometheus + Grafana 연동
- **로깅**: ELK Stack 연동
- **실험 플랫폼**: A/B 테스트 도구 연동

## 7. 제약사항

### 7.1 기술적 제약사항
- **ML 프레임워크**: scikit-learn, TensorFlow 2.x
- **데이터 처리**: pandas, numpy 기반
- **캐싱**: Redis 클러스터 구성
- **모델 서빙**: FastAPI + Docker 컨테이너

### 7.2 알고리즘 제약사항
- **실시간 제약**: 추천 요청 시 즉시 응답 필요
- **메모리 제약**: 인메모리 모델 크기 2GB 이하
- **정확도 vs 성능**: 트레이드오프 균형 유지
- **콜드 스타트**: 신규 사용자/아이템 초기 성능 한계

### 7.3 비즈니스 제약사항
- **공정성**: 모든 작품에 공평한 노출 기회 제공
- **다양성**: 인기작 편중 방지
- **윤리성**: 부적절한 콘텐츠 추천 방지
- **투명성**: 사용자가 추천 이유를 이해할 수 있어야 함